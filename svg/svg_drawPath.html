<html>
  <head>
<title>path</title>

<style>
body {
    -webkit-perspective: 1000;
}

svg {
    border: medium solid gold;
    cursor: pointer;
}

path {
    stroke-width: 6;
}

</style>

</head>
<body>

<select>
    <option>polygon</option>
    <option>quadratic</option>
</select>

<svg></svg>

<script>

var app = new Function();

window.onload = function() {
    app.svg = document.querySelector('svg');
    app.path = document.querySelector('path');
    app.svg.addEventListener('mousedown', app.handleDown);
    app.svg.addEventListener('mouseup', app.handleUp);
    app.svg.addEventListener('mousemove', app.handleMove);
}

app.handleDown = function(e) {
    app.mode = 1;
    app.points = [];
    app.attr = "M " + e.offsetX + " " + e.offsetY;
    app.path = document.createElement("path");
    app.path.setAttribute('stroke-width', 2);
    app.path.setAttribute('stroke', 'black');
    app.svg.appendChild(app.path);
};

app.handleUp = function(e) {
    app.mode = 0;
    if (app.points.length <= 3) return(false);
    for (i = 0, l = app.points.length; i < l; i++) {
        app.attr += " L " + app.points[i];
    }

//    for (i = 0, l = app.points.length; i < l; i += 3) {
//        if (! app.points[i+1] ) break;
//        if (! app.points[i+2] ) break;
//        app.attr += ' C ' + app.points[i] + ', ' + app.points[i+1] + ', ' + app.points[i+2] + ' ';
//    }
    app.path.setAttribute('d', app.attr);
    console.log(app.path);
};

app.handleMove = function(e) { 
    if (!app.mode) return(false);
    app.points.push(e.offsetX + " " + e.offsetY);
};

</script>

</body>
</html>

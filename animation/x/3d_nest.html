<html>
  <head>
<title>nested 3D</title>

<style>

body {
    padding: 130;
}

div {
    box-sizing: border-box;
    position: absolute;
    width: 100px;
    height: 100px;
    outline-offset: 20px;
    outline-width: 3px;
    outline-style: solid;
    cursor: pointer;
}

.scene {
    outline-color: transparent;
    outline-color: pink;
    -webkit-perspective: 500;
}

.dice {
    outline-color: transparent;
    outline-color: lightgreen;
    -webkit-transition: all 0.5s;
/*    -webkit-transition-timing-function: steps(4); */
    -webkit-transform: rotateX(30deg) rotateY(50deg) rotateZ(20deg) scale3D(0,0,0);
    -webkit-transform-style: preserve-3d;
}

.centered {
    outline-color: transparent;
    outline-color: gold;
    -webkit-transform: translateZ(-50px);
    -webkit-transform-style: preserve-3d;
}

.face {
/*    -webkit-backface-visibility: hidden; */
    outline-color: transparent;
    border-radius: 6px;
    border: 2px solid #777;
    background-color: #fff;
    background-repeat: no-repeat;
    background-image: url(dot.png), url(dot.png), url(dot.png),
                      url(dot.png), url(dot.png), url(dot.png);
}

.face:nth-of-type(1) {
    -webkit-transform: rotateY(0deg);
    background-position: 40px 40px, -20px -20px, -20px -20px,
                        -20px -20px, -20px -20px, -20px -20px;
}

.face:nth-of-type(2), .face:nth-of-type(3), .face:nth-of-type(4),
.face:nth-of-type(5), .face:nth-of-type(6) { display: block; }

.face:nth-of-type(6) { display: block; }

.face:nth-of-type(2) {
    -webkit-transform: rotateY(-90deg);
    -webkit-transform-origin: left;
    background-position: 10px 10px, -20px -20px, -20px -20px,
                        -20px -20px, -20px -20px, 70px 70px;
}

.face:nth-of-type(3) {
    -webkit-transform: rotateY(90deg);
    -webkit-transform-origin: right;
    background-position: 10px 10px, 40px 40px, -20px -20px,
                        -20px -20px, -20px -20px, 70px 70px;
}

.face:nth-of-type(4) {
    -webkit-transform: rotateX(90deg);
    -webkit-transform-origin: top;
    background-position: 10px 10px, -20px -20px, 10px 70px,
                         70px 10px, -20px -20px, 70px 70px;
}

.face:nth-of-type(5) {
    -webkit-transform: rotateX(-90deg);
    -webkit-transform-origin: bottom;
    background-position: 10px 10px, -20px -20px, 10px 70px,
                         70px 10px, 40px 40px, 70px 70px;
}

.face:nth-of-type(6) {
    -webkit-backface-visibility: visible;
    -webkit-transform: rotateX(-180deg) translateZ(-100px);
    -webkit-transform-origin: center;
    background-position: 10px 10px, 10px 40px, 10px 70px,
                         70px 10px, 70px 40px, 70px 70px;
}

</style>

</head>
<body>

    <div class="scene">
        <div class="dice">
            <div class="centered">
                <div class="face"></div>
                <div class="face"></div>
                <div class="face"></div>
                <div class="face"></div>
                <div class="face"></div>
                <div class="face"></div>
            </div>
        </div>
    </div>

<script>
window.onload = function() {
// return false;
    var dice = document.querySelector('.dice');
    dice.addEventListener('click', spin);
    dice.style.WebkitTransform = 
        'rotateX(' + randAngle() + ') ' +
        'rotateY(' + randAngle() + ') ' +
        'rotateZ(' + randAngle() + ') ' +
        'scale3D(1,1,1)';
    
};

function spin(e) {
    e.currentTarget.style.WebkitTransform = 
        'rotateX(' + randAngle() + ') ' +
        'rotateY(' + randAngle() + ') ' +
        'rotateZ(' + randAngle() + ') ' +
        'scale3D(1,1,1)';
}

function randAngle() {
    return( Math.floor( Math.random() * 360 ) + 'deg');
}
</script>

</body>
</html>
